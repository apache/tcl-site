<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta content="text/html; charset=ISO-8859-1" http-equiv="Content-Type"><title>Context handling</title><meta name="generator" content="DocBook XSL Stylesheets V1.50.0"><link rel="home" href="index.html" title="Websh Reference"><link rel="up" href="index.html" title="Websh Reference"><link rel="previous" href="logging.html" title="Logging"><link rel="next" href="file_handling_and_file_IO.html" title="File handling and file I/O"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Context handling</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="logging.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="file_handling_and_file_IO.html">Next</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><hr><h2 class="title" style="clear: both"><a name="context_handling"></a>Context handling</h2></div></div><div class="section"><div class="titlepage"><div><h3 class="title"><a name="web::context"></a>web::context</h3></div></div><p style="width:90%">
	Creation
	</p><div class="cmdsynopsis"><span style="background:#bbbbff"><span style="font-weight:bold"><tt>web::context</tt></span>  <tt><span style="text-decoration:underline"><i><tt>name</tt></i></span></tt></span></div><p style="width:90%">
	Creates a namespace <tt><span style="text-decoration:underline">name</span></tt> with the following
	commands:

	</p><div class="cmdsynopsis"><span style="background:#bbbbff"><span style="font-weight:bold"><tt><i><tt>name</tt></i>::subcommand</tt></span>  <tt><span style="text-decoration:underline"><i><tt>args</tt></i></span></tt></span></div><p style="width:90%">

	Subcommands are: <tt><span style="text-decoration:underline">cset</span></tt>,
	<tt><span style="text-decoration:underline">cappend</span></tt>, <tt><span style="text-decoration:underline">clappend</span></tt>,
	<tt><span style="text-decoration:underline">cget</span></tt>, <tt><span style="text-decoration:underline">cexists</span></tt>,
	<tt><span style="text-decoration:underline">cunset</span></tt>, <tt><span style="text-decoration:underline">carray</span></tt>,
	<tt><span style="text-decoration:underline">cnames</span></tt>, and <tt><span style="text-decoration:underline">dump</span></tt>.

	Manages data of the context. The subcommands behave like the
	Tcl commands with similar names.

	</p><div class="variablelist"><dl><dt><span style="background:#bbbbff"><span class="term"><span style="font-family:monospace"><b><i><tt>name</tt></i>::cset</b></span>
	      <tt><span style="text-decoration:underline"><i><tt>key</tt></i></span></tt> <tt><span style="text-decoration:underline"><i><tt>value</tt></i></span></tt></span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		store <tt><span style="text-decoration:underline">value</span></tt>.
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><span style="font-family:monospace"><b><i><tt>name</tt></i>::cappend</b></span>
	      <tt><span style="text-decoration:underline"><i><tt>key</tt></i></span></tt> <tt><span style="text-decoration:underline"><i><tt>value</tt></i></span></tt>
	      ?<tt><span style="text-decoration:underline"><i><tt>value</tt></i></span></tt>?
	      ?<tt><span style="text-decoration:underline"><i><tt>...</tt></i></span></tt>?</span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		append <tt><span style="text-decoration:underline">value</span></tt> to existing value for
		<tt><span style="text-decoration:underline">key</span></tt>.
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><span style="font-family:monospace"><b><i><tt>name</tt></i>::clappend</b></span>
	      <tt><span style="text-decoration:underline"><i><tt>key</tt></i></span></tt> <tt><span style="text-decoration:underline"><i><tt>value</tt></i></span></tt>
	      ?<tt><span style="text-decoration:underline"><i><tt>value</tt></i></span></tt>?
	      ?<tt><span style="text-decoration:underline"><i><tt>...</tt></i></span></tt>?</span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		append <tt><span style="text-decoration:underline">value</span></tt> to existing list of
		values for <tt><span style="text-decoration:underline">key</span></tt>.
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><span style="font-family:monospace"><b><i><tt>name</tt></i>::cget</b></span>
	      <tt><span style="text-decoration:underline"><i><tt>key</tt></i></span></tt>
	      ?<tt><span style="text-decoration:underline"><i><tt>default</tt></i></span></tt>?</span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		access the value for key <tt><span style="text-decoration:underline">key</span></tt>, or
		return <tt><span style="text-decoration:underline">default</span></tt> if
		<tt><span style="text-decoration:underline">key</span></tt> does not exist in the context. If
		<tt><span style="text-decoration:underline">default</span></tt> is omitted, an empty string
		is returned if <tt><span style="text-decoration:underline">key</span></tt> is unknown.
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><span style="font-family:monospace"><b><i><tt>name</tt></i>::cexists</b></span>
	      <tt><span style="text-decoration:underline"><i><tt>key</tt></i></span></tt></span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		returns true (1) if <tt><span style="text-decoration:underline">key</span></tt> exists in
		context, false (0) otherwise.
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><span style="font-family:monospace"><b><i><tt>name</tt></i>::cunset</b></span>
	      <tt><span style="text-decoration:underline"><i><tt>key</tt></i></span></tt></span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		remove <tt><span style="text-decoration:underline">key</span></tt> from context.
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><span style="font-family:monospace"><b><i><tt>name</tt></i>::carray</b></span>
	      <tt><span style="text-decoration:underline"><i><tt>option</tt></i></span></tt> <tt><span style="text-decoration:underline"><i><tt>key</tt></i></span></tt>
	      <tt><span style="text-decoration:underline"><i><tt>arg</tt></i></span></tt></span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		array manipulation as known from the Tcl command
		<span class="emphasis"><em>array</em></span>.
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><span style="font-family:monospace"><b><i><tt>name</tt></i>::cnames</b></span>
	      ?<tt><span style="text-decoration:underline"><i><tt>pattern</tt></i></span></tt>?</span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		lists existing keys of context matching
		<tt><span style="text-decoration:underline">pattern</span></tt>.
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><span style="font-family:monospace"><b><i><tt>name</tt></i>::dump</b></span></span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		serialize context.
	      </div></div></dd></dl></div><p style="width:90%">

	</p><div class="example"><p class="title"><b>Example 8. web::context</b></p><pre style="background:#bbffbb ; width:75%" class="programlisting">
	    % web::context sc
	    % sc::cset lang FR
	    FR
	    % # ... some code ...
	    % set lang [sc::cget lang EN]
	    FR
	    %
	  </pre></div><p style="width:90%">
      </p></div><div class="section"><div class="titlepage"><div><h3 class="title"><a name="web::filecontext"></a>web::filecontext</h3></div></div><p style="width:90%">

	Creation:
	</p><div class="cmdsynopsis"><span style="background:#bbbbff"><span style="font-weight:bold"><tt>web::filecontext</tt></span>  <tt><span style="text-decoration:underline"><i><tt>name</tt></i></span></tt> ?<tt><span style="text-decoration:underline"><i><tt>options</tt></i></span></tt>?</span></div><p style="width:90%">

	Options are: <tt><span style="text-decoration:underline">-perm</span></tt>, <tt><span style="text-decoration:underline">-path</span></tt>,
	<tt><span style="text-decoration:underline">-crypt</span></tt>, <tt><span style="text-decoration:underline">-idgen</span></tt>, and
	<tt><span style="text-decoration:underline">-attachto</span></tt>.

	Creates a namespace <tt><span style="text-decoration:underline">name</span></tt> to manage file-based
	context data:


	</p><div class="cmdsynopsis"><span style="background:#bbbbff"><span style="font-weight:bold"><tt><i><tt>name</tt></i>::subcommand</tt></span>  <tt><span style="text-decoration:underline"><i><tt>args</tt></i></span></tt></span></div><p style="width:90%">

	Subcommands are: <tt><span style="text-decoration:underline">cset</span></tt>,
	<tt><span style="text-decoration:underline">cappend</span></tt>, <tt><span style="text-decoration:underline">clappend</span></tt>,
	<tt><span style="text-decoration:underline">cget</span></tt>, <tt><span style="text-decoration:underline">cexists</span></tt>,
	<tt><span style="text-decoration:underline">cunset</span></tt>, <tt><span style="text-decoration:underline">carray</span></tt>,
	<tt><span style="text-decoration:underline">cnames</span></tt>, <tt><span style="text-decoration:underline">init</span></tt>,
	<tt><span style="text-decoration:underline">new</span></tt>, <tt><span style="text-decoration:underline">commit</span></tt>,
	<tt><span style="text-decoration:underline">invalidate</span></tt>, and <tt><span style="text-decoration:underline">id</span></tt>.

	Manages file-based context data. The subcommands have their
	familiar behaviour of the Tcl commands with similar
	names. Please refer to the section <a href="context_handling.html#context_handling" title="Context handling">context management</a> for a
	description of the commands <tt><span style="text-decoration:underline">cset</span></tt>,
	<tt><span style="text-decoration:underline">cappend</span></tt>, <tt><span style="text-decoration:underline">clappend</span></tt>,
	<tt><span style="text-decoration:underline">cget</span></tt>, <tt><span style="text-decoration:underline">cexists</span></tt>,
	<tt><span style="text-decoration:underline">cunset</span></tt>, <tt><span style="text-decoration:underline">carray</span></tt>, and
	<tt><span style="text-decoration:underline">cnames</span></tt>.

	</p><div class="variablelist"><dl><dt><span style="background:#bbbbff"><span class="term">
	      <span style="font-family:monospace"><b><i><tt>name</tt></i>::init</b></span>
	      ?<tt><span style="text-decoration:underline"><i><tt>id</tt></i></span></tt>?
	    </span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		load an existing session context with id
		<tt><span style="text-decoration:underline">id</span></tt>, or create a new one, if
		possible. Automation depends on the settings of the
		actual context manager settings, see
		below.</div><div style="margin-bottom:6"> If you specify an
		<tt><span style="text-decoration:underline">id</span></tt>, you must decide when to create a
		new file and when to use the old one, if any, by
		yourself.
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><span style="font-family:monospace"><b><i><tt>name</tt></i>::new</b></span>
	      ?<tt><span style="text-decoration:underline"><i><tt>id</tt></i></span></tt>?</span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		create a new session context. Automation depends on
		the settings of the actual context manager settings,
		see below.
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><span style="font-family:monospace"><b><i><tt>name</tt></i>::commit</b></span></span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		make session context persistent.
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><span style="font-family:monospace"><b><i><tt>name</tt></i>::id</b></span></span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		return id of session.
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><span style="font-family:monospace"><b><i><tt>name</tt></i>::invalidate</b></span></span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		delete session in memory and on file system.
	      </div></div></dd></dl></div><p style="width:90%">

	Options:
	</p><div class="cmdsynopsis"><span style="background:#bbbbff"><span style="font-weight:bold"><tt>web::filecontext</tt></span>  <tt><span style="text-decoration:underline"><i><tt>name</tt></i></span></tt> <tt><span style="text-decoration:underline">-perm</span></tt> <tt><span style="text-decoration:underline"><i><tt>perm</tt></i></span></tt></span></div><p style="width:90%">

	set the file permissions of the session context files
	<tt><span style="text-decoration:underline">perm</span></tt> is an unix-like octal value like 0644.

	</p><div class="variablelist"><dl><dt><span style="background:#bbbbff"><span class="term"><span style="font-family:monospace"><b>web::filecontext</b></span>
	      <tt><span style="text-decoration:underline"><i><tt>name</tt></i></span></tt> <tt><span style="text-decoration:underline">-path</span></tt>
	      <tt><span style="text-decoration:underline"><i><tt>path</tt></i></span></tt>
	    </span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		specify where to store session context files and how
		to name them. Suppose that the session id is 99.
		<span class="emphasis"><em>-path [file join .. data s%d.dat]</em></span>
		would then cause filecontext to save the session
		context as <tt>../data/s99.dat</tt>.
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><span style="font-family:monospace"><b>web::filecontext</b></span>
	      <tt><span style="text-decoration:underline"><i><tt>name</tt></i></span></tt> <tt><span style="text-decoration:underline">-crypt</span></tt>
	      <tt><span style="text-decoration:underline">boolean</span></tt></span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		Flag to turn crypting of session context on and off.
		Default is on.
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><span style="font-family:monospace"><b>web::filecontext</b></span>
	      <tt><span style="text-decoration:underline"><i><tt>name</tt></i></span></tt> <tt><span style="text-decoration:underline">-idgen</span></tt>
	      <tt><span style="text-decoration:underline"><i><tt>idgen</tt></i></span></tt></span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		Sets command <tt><span style="text-decoration:underline">idgen</span></tt> to find a new
		session id. See doc of
		<span style="font-family:monospace"><b>web::filecounter</b></span> below for an
		implementation provided with Websh.
	      </div><div style="margin-bottom:6">
		<tt><span style="text-decoration:underline">idgen</span></tt> is used in case that no
		<tt><span style="text-decoration:underline">id</span></tt> argument has been passed to
		<tt><span style="text-decoration:underline">init</span></tt> or <tt><span style="text-decoration:underline">new</span></tt>.
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><span style="font-family:monospace"><b>web::filecontext</b></span>
	      <tt><span style="text-decoration:underline"><i><tt>name</tt></i></span></tt> <tt><span style="text-decoration:underline">-attachto</span></tt>
	      <tt><span style="text-decoration:underline"><i><tt>idparam</tt></i></span></tt>
	    </span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		the next using the querystring (this is one reason why
		the querystring is encrypted). After web::dispatch has
		parsed the querystring, web::param will report the
		current session id, if any. <span class="emphasis"><em>Note</em></span>
		that you can maintain several sessions in parallel,
		and attach every session to its own
		<tt><span style="text-decoration:underline">idparam</span></tt>.
	      </div><div style="margin-bottom:6">
		Using <span class="emphasis"><em>web::dispatch -track</em></span>
		further automates the passing of session ids from
		request to request.
	      </div></div></dd></dl></div><p style="width:90%">

	<span class="emphasis"><em>Note:</em></span> Whenever you create a new
	file-based context, the context is initialized and you loose
	whatever information that you might have stored in the context
	before you initialized it as a file-based session context.

      </p></div><div class="section"><div class="titlepage"><div><h3 class="title"><a name="web::cookiecontext"></a>web::cookiecontext</h3></div></div><p style="width:90%">

	Creation:

	</p><div class="cmdsynopsis"><span style="background:#bbbbff"><span style="font-weight:bold"><tt>web::cookiecontext</tt></span>  <tt><span style="text-decoration:underline"><i><tt>name</tt></i></span></tt> ?<tt><span style="text-decoration:underline"><i><tt>options</tt></i></span></tt>?</span></div><p style="width:90%">

	Options are: <tt><span style="text-decoration:underline">-expires</span></tt>,
	<tt><span style="text-decoration:underline">-path</span></tt>, <tt><span style="text-decoration:underline">-domain</span></tt>,
	<tt><span style="text-decoration:underline">-secure</span></tt>, <tt><span style="text-decoration:underline">-crypt</span></tt>, and
	<tt><span style="text-decoration:underline">-channel</span></tt>.

	Creates a namespace <tt><span style="text-decoration:underline">name</span></tt> to manage
	cookie-based context data:

	</p><div class="variablelist"><dl><dt><span style="background:#bbbbff"></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		<span style="font-family:monospace"><b><i><tt>name</tt></i>::subcommand</b></span>
		<tt><span style="text-decoration:underline"><i><tt>args</tt></i></span></tt></div><div style="margin-bottom:6">
		Subcommands are: <tt><span style="text-decoration:underline">cset</span></tt>,
		<tt><span style="text-decoration:underline">cappend</span></tt>, <tt><span style="text-decoration:underline">clappend</span></tt>,
		<tt><span style="text-decoration:underline">cget</span></tt>, <tt><span style="text-decoration:underline">cexists</span></tt>,
		<tt><span style="text-decoration:underline">cunset</span></tt>, <tt><span style="text-decoration:underline">carray</span></tt>,
		<tt><span style="text-decoration:underline">cnames</span></tt>, <tt><span style="text-decoration:underline">init</span></tt>,
		<tt><span style="text-decoration:underline">new</span></tt>, <tt><span style="text-decoration:underline">commit</span></tt>,
		<tt><span style="text-decoration:underline">invalidate</span></tt>, and <tt><span style="text-decoration:underline">id</span></tt>.
	      </div></div></dd></dl></div><p style="width:90%">

	</p><div class="variablelist"><dl><dt><span style="background:#bbbbff"><span class="term"><span style="font-family:monospace"><b><i><tt>name</tt></i>::init</b></span>
	      ?<tt><span style="text-decoration:underline"><i><tt>id</tt></i></span></tt>?</span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		load an existing session context (cookie must have
		been sent by the client).
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><span style="font-family:monospace"><b><i><tt>name</tt></i>::new</b></span>
	      ?<tt><span style="text-decoration:underline"><i><tt>id</tt></i></span></tt>?</span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		create a new session context.
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><span style="font-family:monospace"><b><i><tt>name</tt></i>::commit</b></span></span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		send a cookie.
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><span style="font-family:monospace"><b><i><tt>name</tt></i>::id</b></span></span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		return id of session.
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><span style="font-family:monospace"><b><i><tt>name</tt></i>::invalidate</b></span></span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		delete session in memory and on client side.
	      </div></div></dd></dl></div><p style="width:90%">

	Options:

	</p><div class="variablelist"><dl><dt><span style="background:#bbbbff"><span class="term"><span style="font-family:monospace"><b>web::cookiecontext</b></span>
	      <tt><span style="text-decoration:underline"><i><tt>name</tt></i></span></tt> <tt><span style="text-decoration:underline">-expires</span></tt>
	      <tt><span style="text-decoration:underline"><i><tt>time</tt></i></span></tt></span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		set the expiration date of the cookie. Possible values
		for <tt><span style="text-decoration:underline">time</span></tt> are <span class="emphasis"><em>day</em></span>
		(lifetime: one day), <span class="emphasis"><em>week</em></span>,
		<span class="emphasis"><em>today</em></span>,
		<span class="emphasis"><em>seconds</em></span> (time in seconds since
		1-1-1970) or <span class="emphasis"><em>date-string</em></span>.
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><span style="font-family:monospace"><b>web::cookiecontext</b></span>
	      <tt><span style="text-decoration:underline"><i><tt>name</tt></i></span></tt> <tt><span style="text-decoration:underline">-path</span></tt>
	      <tt><span style="text-decoration:underline"><i><tt>path</tt></i></span></tt></span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		set the <tt><span style="text-decoration:underline">path</span></tt> property of the cookie.
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><span style="font-family:monospace"><b>web::cookiecontext</b></span>
	      <tt><span style="text-decoration:underline"><i><tt>name</tt></i></span></tt> <tt><span style="text-decoration:underline">-domain</span></tt>
	      <tt><span style="text-decoration:underline"><i><tt>domain</tt></i></span></tt></span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		set the <tt><span style="text-decoration:underline">domain</span></tt> property of the cookie.
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><span style="font-family:monospace"><b>web::cookiecontext</b></span>
	      <tt><span style="text-decoration:underline"><i><tt>name</tt></i></span></tt>
	      <tt><span style="text-decoration:underline">-secure</span></tt> <tt><span style="text-decoration:underline">boolean</span></tt></span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		set the <tt><span style="text-decoration:underline">secure</span></tt> property of the cookie.
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><span style="font-family:monospace"><b>web::cookiecontext</b></span>
	      <tt><span style="text-decoration:underline"><i><tt>name</tt></i></span></tt> <tt><span style="text-decoration:underline">-crypt</span></tt>
	      <tt><span style="text-decoration:underline">boolean</span></tt></span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		Flag to turn crypting of cookie context on and off.
		Default is on.
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><span style="font-family:monospace"><b>web::cookiecontext</b></span>
	      <tt><span style="text-decoration:underline"><i><tt>name</tt></i></span></tt> <tt><span style="text-decoration:underline">-channel</span></tt>
	      <tt><span style="text-decoration:underline"><i><tt>channelName</tt></i></span></tt></span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		The response object to send the cookie to (see also
		<span style="font-family:monospace"><b>web::response</b></span>).
	      </div></div></dd></dl></div><p style="width:90%">

	Because cookies are client-based, in principle no id is
	needed. Websh uses <tt><span style="text-decoration:underline">id</span></tt> to name the cookie,
	however, and the <span style="font-family:monospace"><b>new</b></span>,
	<span style="font-family:monospace"><b>init</b></span>, and <span style="font-family:monospace"><b>load</b></span> commands
	still require the <tt><span style="text-decoration:underline">id</span></tt> argument. (fixme: any
	changes?) Please note that property settings of a cookie
	context can only be changed <span class="emphasis"><em>before</em></span>
	anything is output on the respective channel.

      </p></div><div class="section"><div class="titlepage"><div><h3 class="title"><a name="web::filecounter"></a>web::filecounter</h3></div></div><p style="width:90%">

	This is a numeric sequence-number generator which stores its
	state in a file. Basic usage:

	</p><div class="variablelist"><dl><dt><span style="background:#bbbbff"><span class="term">Creation:</span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		<span style="font-family:monospace"><b>web::filecounter</b></span>
		<tt><span style="text-decoration:underline"><i><tt>name</tt></i></span></tt> <tt><span style="text-decoration:underline">-filename</span></tt>
		<tt><span style="text-decoration:underline"><i><tt>fname</tt></i></span></tt>
		?<tt><span style="text-decoration:underline"><i><tt>options</tt></i></span></tt>?
	      </div><div style="margin-bottom:6">
		Options are: <tt><span style="text-decoration:underline">-min</span></tt>,
		<tt><span style="text-decoration:underline">-max</span></tt>, <tt><span style="text-decoration:underline">-seed</span></tt>,
		<tt><span style="text-decoration:underline">-incr</span></tt>, <tt><span style="text-decoration:underline">-mask</span></tt>,
		<tt><span style="text-decoration:underline">-wrap</span></tt>
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><tt><span style="text-decoration:underline">-filename</span></tt>
	      <tt><span style="text-decoration:underline"><i><tt>filename</tt></i></span></tt></span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		uses <tt><span style="text-decoration:underline">filename</span></tt> to store the current
		value (no default)
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><tt><span style="text-decoration:underline">-min</span></tt> <tt><span style="text-decoration:underline"><i><tt>value</tt></i></span></tt></span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		uses this value as a minimum at start and after wrap,
		if wrap is true (default is 0).
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><tt><span style="text-decoration:underline">-max</span></tt> <tt><span style="text-decoration:underline"><i><tt>value</tt></i></span></tt></span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		uses this value as a maximum, if wrap is true (default is 2147483647).
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><tt><span style="text-decoration:underline">-seed</span></tt> <tt><span style="text-decoration:underline"><i><tt>value</tt></i></span></tt></span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		if persistent file does not yet exists, use this value
		as a starting point (default is 0).
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><tt><span style="text-decoration:underline">-incr</span></tt> <tt><span style="text-decoration:underline"><i><tt>value</tt></i></span></tt></span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		uses this value as an increment for each 'nextval'
		(default is 1).
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><tt><span style="text-decoration:underline">-perms</span></tt>
	      <tt><span style="text-decoration:underline"><i><tt>value</tt></i></span></tt></span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		sets the permissions on the newly created files
		(default is 0644).
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><tt><span style="text-decoration:underline">-wrap</span></tt>
	      <tt><span style="text-decoration:underline">boolean</span></tt></span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		indicates whether this counter should wrap around its
		values (from min to max) (default is false).
	      </div></div></dd></dl></div><p style="width:90%">

	After creation, a new command <tt><span style="text-decoration:underline">name</span></tt> is
	registered with the following two subcommands:

	</p><div class="variablelist"><dl><dt><span style="background:#bbbbff"><span class="term"><tt><span style="text-decoration:underline"><i><tt>name</tt></i></span></tt> nextval</span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		return the next value.
	      </div></div></dd><dt><span style="background:#bbbbff"><span class="term"><tt><span style="text-decoration:underline"><i><tt>name</tt></i></span></tt> curval</span></span></dt><dd><div style="padding:4 ; margin-top:3 ;  margin-bottom:3 ; width:75%"><div style="margin-bottom:6">
		return the current value, that is, the value that the
		last call to &quot;nextval&quot; reported (as opposed
		to the current value in the file).
	      </div></div></dd></dl></div><p style="width:90%">

      </p><div class="example"><p class="title"><b>Example 9. web::filecounter</b></p><pre style="background:#bbffbb ; width:75%" class="programlisting">
	  % web::filecounter handleName -filename &quot;test.dat&quot;
	  handleName
	  % # from now on, use handleName &lt;curval|nextval|config&gt;
	  % handleName config
	  file test.dat handle handleName seed 0 min 0 max 2147483647 incr 1 wrap false curr {not valid}
	  % web::filecounter otherHandleName -filename &quot;othertest.dat&quot; -min 1 -max 10 -seed 1 -incr 2 -wrap 1
	  otherHandleName
	  % otherHandleName config
	  file othertest.dat handle otherHandleName seed 1 min 1 max 10 incr 2 wrap true curr {not valid}
	  %
	</pre></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="logging.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="index.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="file_handling_and_file_IO.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Logging </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> File handling and file I/O</td></tr></table></div></body></html>
